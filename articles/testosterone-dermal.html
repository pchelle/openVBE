<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Testosterone Dermal • openVBE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Testosterone Dermal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">openVBE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bupropion-oral.html">Bupropion Oral</a>
    </li>
    <li>
      <a href="../articles/testosterone-dermal.html">Testosterone Dermal</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/abdullahhamadeh/openVBE/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Testosterone Dermal</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/abdullahhamadeh/openVBE/blob/master/vignettes/testosterone-dermal.Rmd" class="external-link"><code>vignettes/testosterone-dermal.Rmd</code></a></small>
      <div class="hidden name"><code>testosterone-dermal.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="testosterone-dermal-absorption-model-case-study">Testosterone dermal absorption model case study<a class="anchor" aria-label="anchor" href="#testosterone-dermal-absorption-model-case-study"></a>
</h2>
<p>The absorption of active ingredients applied to the skin is heavily
influenced by the choice of vehicle [9-12]. Differences in skin
permeation arise due to variation in how the active ingredient
partitions from a formulation into the skin, and also due to inactive
ingredients in the formulation that can alter diffusivity across the
skin strata [13]. Mechanistic models of dermal absorption of small
molecules from dermal formulations have been developed by the Kasting
group [14, 15] and have been translated into open source implementations
in the OSP Suite quantitative systems pharmacology modeling platform,
MoBi® [16]. Subsequently, the MoBi® implementation has been used to
develop a dermal model Bayesian IVIVE workflow [17] and to develop a
model of UV filter absorption and systemic exposure following sunscreen
applications [18].</p>
<p>The MoBi® implementation mentioned above describes the permeation of
compounds from a vehicle deposited on the skin surface into the stratum
corneum, the viable epidermis, and the dermis. Clearance from the dermis
can be modeled as being into a receptor fluid medium when simulating in
vitro skin permeation tests, or into systemic circulation when
simulating in vivo dermal absorption. To simulate the disposition of
dermally applied compounds following their absorption into systemic
circulation, the MoBi® model can also be appended to PK-Sim® PBPK
whole-body PBPK models or, as in the case of Hamadeh et al. [18], it can
be appended to one- or two-compartment models. Further details on model
structure, assumptions and development are provided in Supplementary
Materials 1.</p>
<p>This case study uses an integrated model consisting of the MoBi®
dermal absorption model appended to a single systemic compartment to
assess VBE between two topical testosterone formulations. The
one-compartment systemic model is parameterized by the apparent
clearance and volume of distribution of testosterone reported in Bi et
al. [19]. The two testosterone formulations are those studied in
Bronaugh &amp; Franz [9]. That work reported the skin absorption flux
rates for testosterone when applied to human skin under both in vitro
and in vivo settings in a petrolatum vehicle and in an ethylene glycol
gel vehicle. The applied vehicle mass per unit area was 25
mg/cm<sup>2</sup> in all four cases, and the testosterone dose within
the vehicles was 2 μg/cm<sup>2</sup> for all applications except the
ethylene glycol application to in vivo skin, which was applied at a dose
of 3 μg/cm<sup>2</sup>. Here, the proposed workflow is applied towards
VBE assessments of the petrolatum (assumed to be the R product)
formulation and the ethylene glycol (assumed to be the T product)
formulation and will be assessed at a testosterone strength of 2
μg/cm<sup>2</sup>, applied in a 25 mg/cm<sup>2</sup> vehicle.</p>
</div>
<div class="section level2">
<h2 id="dermal-application-case-study-data-sets">Dermal application case study data sets<a class="anchor" aria-label="anchor" href="#dermal-application-case-study-data-sets"></a>
</h2>
<p>As Bronaugh &amp; Franz [9] did not provide testosterone plasma
concentration data for subjects treated with the petrolatum formulation,
for the purposes of this case study, we used their reported testosterone
dermal absorption rate along with the testosterone systemic clearance
and volume of distribution values from Bi et al. [19], to generate
simulated plasma concentration profiles as described in Supplementary
Materials 1. These individualized profiles are used as data set D1 for
this illustrative example, and each profile is associated with a virtual
individual characterized by body weight. The collective body weights of
all virtual individuals in this example constitute data set D2. The
distribution of body weights is derived from Bi et al. [19].</p>
<div class="section level3">
<h3 id="openvbe-code">openVBE code<a class="anchor" aria-label="anchor" href="#openvbe-code"></a>
</h3>
<p>The following code gets the Data sets D1 and D2 from
<code>pkDataFilePath = "pk_data_reference.csv"</code> and
<code>studyPopulationDataFilePath = "population_data.csv"</code>
respectively.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://abdullahhamadeh.github.io/openVBE/" class="external-link">openVBE</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ospsuite</span></span>
<span><span class="co">#&gt; Loading required package: rSharp</span></span>
<span><span class="co">#&gt; Loading required package: mclust</span></span>
<span><span class="co">#&gt; Package 'mclust' version 6.1.1</span></span>
<span><span class="co">#&gt; Type 'citation("mclust")' for citing this R package in publications.</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'stats::filter' by 'dplyr::filter' when</span></span>
<span><span class="co">#&gt; loading 'openVBE'</span></span>
<span></span>
<span><span class="va">dateTime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"%Y%m%d"</span><span class="op">)</span>, <span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"%H%M%S"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">exampleName</span> <span class="op">&lt;-</span> <span class="st">"testosterone-dermal"</span></span>
<span><span class="va">subfolder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="va">exampleName</span>, package<span class="op">=</span><span class="st">"openVBE"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># D1</span></span>
<span><span class="va">pkDataFilePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">subfolder</span>, <span class="st">"pk_data_reference.csv"</span><span class="op">)</span></span>
<span><span class="co"># D2</span></span>
<span><span class="va">studyPopulationDataFilePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">subfolder</span>,<span class="st">"population_data.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="step-w1---pk-model-development">Step W1 - PK model development<a class="anchor" aria-label="anchor" href="#step-w1---pk-model-development"></a>
</h2>
<p>The MoBi® skin absorption model [16] was optimized, as described in
Supplementary Materials 1, to the in vitro testosterone absorption
measurements reported for the petrolatum and ethylene glycol vehicles in
Bronaugh &amp; Franz [9] and then externally validated against the in
vivo testosterone absorption rates following application in the
petrolatum vehicle. Two vehicle -specific parameters were optimized
based on the in vitro data: the vehicle/stratum corneum partition
coefficient,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mrow><mi>v</mi><mi>/</mi><mi>s</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">K_{v/sc}</annotation></semantics></math>,
and the vehicle-specific effect on testosterone permeability across
stratum corneum lipid bilayers,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">\Delta_{trans}</annotation></semantics></math>.</p>
<p>Once validated, the resulting testosterone dermal absorption model
was appended to a single systemic compartment to represent in vivo
systemic concentrations following absorption from skin. The nominal
values of testosterone clearance and volume of distribution for the
systemic compartment were adopted from Bi et al. [19]. Two such in vivo
testosterone dermal absorption models were constructed, one for each
vehicle. The testosterone systemic disposition in these two models was
assumed to be the same, and the only differences between them lay in
their respective values of the optimized vehicle-specific parameters,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mrow><mi>v</mi><mi>/</mi><mi>s</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">K_{v/sc}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">\Delta_{trans}</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="openvbe-code-1">openVBE code<a class="anchor" aria-label="anchor" href="#openvbe-code-1"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">referenceSimulationFilePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">subfolder</span>,<span class="st">"reference_formulation.pkml"</span><span class="op">)</span></span>
<span><span class="va">testSimulationFilePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">subfolder</span>,<span class="st">"test_formulation.pkml"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="step-w2---learning-posterior-distributions-of-iiv-and-ivive-parameters">Step W2 - Learning posterior distributions of IIV and IVIVE
parameters<a class="anchor" aria-label="anchor" href="#step-w2---learning-posterior-distributions-of-iiv-and-ivive-parameters"></a>
</h2>
<p>Based on sensitivity analyses conducted in Hamadeh et al. [17] on the
MoBi® skin absorption model, permeability across stratum corneum lipid
bilayers
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>k</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\log k_{trans}</annotation></semantics></math>)
was identified as an influential parameter in the dermal absorption of
testosterone. An additive individual-specific perturbation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\theta_1</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>k</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\log k_{trans}</annotation></semantics></math>,
ranging within
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[-1,1]</annotation></semantics></math>,
was selected for inference from the data set <strong>D1</strong>. Also
selected for inference from this data set is a scaling parameter,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\theta_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\theta_2</annotation></semantics></math>
and the demographic description of the virtual population, which, in
this example, consists of the individual weight. The posterior
probability of each support point is given by the point color.</p>
<div class="section level3">
<h3 id="openvbe-code-2">openVBE code<a class="anchor" aria-label="anchor" href="#openvbe-code-2"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outputPath</span> <span class="op">&lt;-</span> <span class="st">"DERMAL_APPLICATION_AREA|in_vivo_sink|permeant|whole_body_concentration"</span></span>
<span></span>
<span><span class="va">uncertainty_logktrans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VBEParameter.html">vbeParameter</a></span><span class="op">(</span></span>
<span>  pathInReferenceSimulation <span class="op">=</span> <span class="st">"permeant|uncertainty_logktrans"</span>,</span>
<span>  pathInTestSimulation <span class="op">=</span> <span class="st">"permeant|uncertainty_logktrans"</span>,</span>
<span>  displayName <span class="op">=</span> <span class="st">"uncertainty_logktrans"</span>,</span>
<span>  dimension <span class="op">=</span> <span class="va">ospDimensions</span><span class="op">$</span><span class="va">Dimensionless</span>,</span>
<span>  unit <span class="op">=</span> <span class="va">ospUnits</span><span class="op">$</span><span class="va">Dimensionless</span><span class="op">$</span><span class="va">Unitless</span>,</span>
<span>  lowerBound <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  upperBound <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  logIncrement <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">scaling_total_clearance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VBEParameter.html">vbeParameter</a></span><span class="op">(</span></span>
<span>  pathInReferenceSimulation <span class="op">=</span> <span class="st">"in_vivo_sink_clearance|scaling_total_clearance"</span>,</span>
<span>  pathInTestSimulation <span class="op">=</span> <span class="st">"in_vivo_sink_clearance|scaling_total_clearance"</span>,</span>
<span>  displayName <span class="op">=</span> <span class="st">"scaling_total_clearance"</span>,</span>
<span>  dimension <span class="op">=</span> <span class="va">ospDimensions</span><span class="op">$</span><span class="va">Dimensionless</span>,</span>
<span>  unit <span class="op">=</span> <span class="va">ospUnits</span><span class="op">$</span><span class="va">Dimensionless</span><span class="op">$</span><span class="va">Unitless</span>,</span>
<span>  lowerBound <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  upperBound <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  logIncrement <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">inferenceParameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">uncertainty_logktrans</span>, <span class="va">scaling_total_clearance</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cofactorPaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"DERMAL_APPLICATION_AREA|in_vivo_sink|body_weight"</span><span class="op">)</span></span></code></pre></div>
<p>Learns the posterior distributions of
<code>uncertainty_logktrans</code>,
<code>scaling_total_clearance</code>, and <code>weight</code> IIV
parameters and cofactors.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inferredDistribution</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runDistributionInference.html">runDistributionInference</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"NPOD"</span>,</span>
<span>  referenceSimulationFilePath <span class="op">=</span> <span class="va">referenceSimulationFilePath</span>,</span>
<span>  outputPath <span class="op">=</span> <span class="va">outputPath</span>,</span>
<span>  pkDataFilePath <span class="op">=</span> <span class="va">pkDataFilePath</span>,</span>
<span>  studyPopulationDataFilePath <span class="op">=</span> <span class="va">studyPopulationDataFilePath</span>,</span>
<span>  cofactorPaths <span class="op">=</span> <span class="va">cofactorPaths</span>,</span>
<span>  inferenceParameters <span class="op">=</span> <span class="va">inferenceParameters</span>,</span>
<span>  initialGridSize <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  numberOfIterations <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  useLogNormalLikelihood <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  saveResultsPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">exampleName</span>,<span class="st">"-npod-results-"</span>,<span class="va">dateTime</span>,<span class="st">".rds"</span><span class="op">)</span>,</span>
<span>  cacheFolder <span class="op">=</span> <span class="st">"cacheFolder"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Starting NPOD"</span></span>
<span><span class="co">#&gt; [1] "Starting optimization run:"</span></span>
<span><span class="co">#&gt; [1] "theta:"</span></span>
<span><span class="co">#&gt;      [,1]  [,2] [,3]   [,4]  [,5]   [,6]  [,7]    [,8]   [,9]   [,10]  [,11]</span></span>
<span><span class="co">#&gt; [1,]    0 -0.50 0.50 -0.750 0.250 -0.250 0.750 -0.8750 0.1250 -0.3750 0.6250</span></span>
<span><span class="co">#&gt; [2,]    1  1.25 0.75  1.125 0.625  0.875 1.375  1.4375 0.9375  0.6875 1.1875</span></span>
<span><span class="co">#&gt;        [,12]  [,13]   [,14]  [,15]    [,16]   [,17]    [,18]   [,19]    [,20]</span></span>
<span><span class="co">#&gt; [1,] -0.6250 0.3750 -0.1250 0.8750 -0.93750 0.06250 -0.43750 0.56250 -0.68750</span></span>
<span><span class="co">#&gt; [2,]  0.8125 1.3125  1.0625 0.5625  1.03125 0.53125  0.78125 1.28125  0.65625</span></span>
<span><span class="co">#&gt;        [,21]    [,22]   [,23]    [,24]   [,25]    [,26]   [,27]    [,28]</span></span>
<span><span class="co">#&gt; [1,] 0.31250 -0.18750 0.81250 -0.81250 0.18750 -0.31250 0.68750 -0.56250</span></span>
<span><span class="co">#&gt; [2,] 1.15625  1.40625 0.90625  0.96875 1.46875  1.21875 0.71875  1.34375</span></span>
<span><span class="co">#&gt;        [,29]    [,30]   [,31]     [,32]    [,33]     [,34]    [,35]     [,36]</span></span>
<span><span class="co">#&gt; [1,] 0.43750 -0.06250 0.93750 -0.968750 0.031250 -0.468750 0.531250 -0.718750</span></span>
<span><span class="co">#&gt; [2,] 0.84375  0.59375 1.09375  1.296875 0.796875  0.546875 1.046875  0.921875</span></span>
<span><span class="co">#&gt;         [,37]     [,38]    [,39]     [,40]</span></span>
<span><span class="co">#&gt; [1,] 0.281250 -0.218750 0.781250 -0.843750</span></span>
<span><span class="co">#&gt; [2,] 1.421875  1.171875 0.671875  0.734375</span></span>
<span><span class="co">#&gt; [1] "lambda:"</span></span>
<span><span class="co">#&gt;  [1] 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025</span></span>
<span><span class="co">#&gt; [13] 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025</span></span>
<span><span class="co">#&gt; [25] 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025</span></span>
<span><span class="co">#&gt; [37] 0.025 0.025 0.025 0.025</span></span>
<span><span class="co">#&gt; [1] "After Condense 2"</span></span>
<span><span class="co">#&gt; [1] "theta:"</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "lambda:"</span></span>
<span><span class="co">#&gt;  [1] 0.002411838 0.001413493 0.952626201 0.001155724 0.008029559 0.002474677</span></span>
<span><span class="co">#&gt;  [7] 0.015833738 0.001166835 0.006807033 0.006724929</span></span>
<span><span class="co">#&gt; [1] "After Condense 2"</span></span>
<span><span class="co">#&gt; [1] "theta:"</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "lambda:"</span></span>
<span><span class="co">#&gt;  [1] 0.002791402 0.001978164 0.956164132 0.001747391 0.006934266 0.002839938</span></span>
<span><span class="co">#&gt;  [7] 0.013811496 0.001757617 0.006018121 0.005957472</span></span>
<span><span class="co">#&gt; [1] "Starting fminsearch and prune"</span></span>
<span><span class="co">#&gt; [1] "Starting fminsearch..."</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; fminsearch:  Exiting: Maximum number of iterations has been exceeded</span></span>
<span><span class="co">#&gt;          - increase MaxIter option.</span></span>
<span><span class="co">#&gt;          Current function value: -0.00103867975222016</span></span>
<span><span class="co">#&gt; [1] "fminserarch complete"</span></span>
<span><span class="co">#&gt; [1] "prune..."</span></span>
<span><span class="co">#&gt; [1] "Rejecting candidate support point: (-1.41697265625, 8.86083984375002)."</span></span>
<span><span class="co">#&gt; [1] "Reason: Outside of bounds."</span></span>
<span><span class="co">#&gt; [1] "...complete."</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "Starting fminsearch..."</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; fminsearch:  Exiting: Maximum number of iterations has been exceeded</span></span>
<span><span class="co">#&gt;          - increase MaxIter option.</span></span>
<span><span class="co">#&gt;          Current function value: -0.000387362115009893</span></span>
<span><span class="co">#&gt; [1] "fminserarch complete"</span></span>
<span><span class="co">#&gt; [1] "prune..."</span></span>
<span><span class="co">#&gt; [1] "Rejecting candidate support point: (2.21520996093751, -5.279052734375)."</span></span>
<span><span class="co">#&gt; [1] "Reason: Outside of bounds."</span></span>
<span><span class="co">#&gt; [1] "...complete."</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "Starting fminsearch..."</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; fminsearch:  Exiting: Maximum number of iterations has been exceeded</span></span>
<span><span class="co">#&gt;          - increase MaxIter option.</span></span>
<span><span class="co">#&gt;          Current function value: -0.000260332171183819</span></span>
<span><span class="co">#&gt; [1] "fminserarch complete"</span></span>
<span><span class="co">#&gt; [1] "prune..."</span></span>
<span><span class="co">#&gt; [1] "Rejecting candidate support point: (0.675634765624995, -5.3642578125)."</span></span>
<span><span class="co">#&gt; [1] "Reason: Outside of bounds."</span></span>
<span><span class="co">#&gt; [1] "...complete."</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "Starting fminsearch..."</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; Timing stopped at: 5.351 0.018 2.058</span></span>
<span><span class="co">#&gt; [1] "fminserarch complete"</span></span>
<span><span class="co">#&gt; [1] "prune..."</span></span>
<span><span class="co">#&gt; [1] "...complete."</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "Starting fminsearch..."</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; fminsearch:  Exiting: Maximum number of iterations has been exceeded</span></span>
<span><span class="co">#&gt;          - increase MaxIter option.</span></span>
<span><span class="co">#&gt;          Current function value: -0.000110825722817509</span></span>
<span><span class="co">#&gt; [1] "fminserarch complete"</span></span>
<span><span class="co">#&gt; [1] "prune..."</span></span>
<span><span class="co">#&gt; [1] "Rejecting candidate support point: (0.164727783203125, -4.48719482421876)."</span></span>
<span><span class="co">#&gt; [1] "Reason: Outside of bounds."</span></span>
<span><span class="co">#&gt; [1] "...complete."</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "Starting fminsearch..."</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; Timing stopped at: 5.405 0.018 2.063</span></span>
<span><span class="co">#&gt; [1] "fminserarch complete"</span></span>
<span><span class="co">#&gt; [1] "prune..."</span></span>
<span><span class="co">#&gt; [1] "...complete."</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "Starting fminsearch..."</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; fminsearch:  Exiting: Maximum number of iterations has been exceeded</span></span>
<span><span class="co">#&gt;          - increase MaxIter option.</span></span>
<span><span class="co">#&gt;          Current function value: -0.00138521539658498</span></span>
<span><span class="co">#&gt; [1] "fminserarch complete"</span></span>
<span><span class="co">#&gt; [1] "prune..."</span></span>
<span><span class="co">#&gt; [1] "Rejecting candidate support point: (-1.5837158203125, 13.0143585205077)."</span></span>
<span><span class="co">#&gt; [1] "Reason: Outside of bounds."</span></span>
<span><span class="co">#&gt; [1] "...complete."</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "Starting fminsearch..."</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; fminsearch:  Exiting: Maximum number of iterations has been exceeded</span></span>
<span><span class="co">#&gt;          - increase MaxIter option.</span></span>
<span><span class="co">#&gt;          Current function value: -4.23928240422811e-05</span></span>
<span><span class="co">#&gt; [1] "fminserarch complete"</span></span>
<span><span class="co">#&gt; [1] "prune..."</span></span>
<span><span class="co">#&gt; [1] "Rejecting candidate support point: (-0.553802490234376, 1.56491394042969)."</span></span>
<span><span class="co">#&gt; [1] "Reason: Outside of bounds."</span></span>
<span><span class="co">#&gt; [1] "...complete."</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "Starting fminsearch..."</span></span>
<span><span class="co">#&gt; [1] 9</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; fminsearch:  Exiting: Maximum number of iterations has been exceeded</span></span>
<span><span class="co">#&gt;          - increase MaxIter option.</span></span>
<span><span class="co">#&gt;          Current function value: -9.78589575630906e-05</span></span>
<span><span class="co">#&gt; [1] "fminserarch complete"</span></span>
<span><span class="co">#&gt; [1] "prune..."</span></span>
<span><span class="co">#&gt; [1] "Rejecting candidate support point: (-0.263952636718751, 7.06098175048828)."</span></span>
<span><span class="co">#&gt; [1] "Reason: Outside of bounds."</span></span>
<span><span class="co">#&gt; [1] "...complete."</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "Starting fminsearch..."</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; fminsearch:  Exiting: Maximum number of iterations has been exceeded</span></span>
<span><span class="co">#&gt;          - increase MaxIter option.</span></span>
<span><span class="co">#&gt;          Current function value: -0.000374028428197448</span></span>
<span><span class="co">#&gt; [1] "fminserarch complete"</span></span>
<span><span class="co">#&gt; [1] "prune..."</span></span>
<span><span class="co">#&gt; [1] "Rejecting candidate support point: (1.8279052734375, -5.22289123535154)."</span></span>
<span><span class="co">#&gt; [1] "Reason: Outside of bounds."</span></span>
<span><span class="co">#&gt; [1] "...complete."</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "Completed fminsearch and prune"</span></span>
<span><span class="co">#&gt; [1] "Counter: "</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; [1] "Starting optimization run:"</span></span>
<span><span class="co">#&gt; [1] "theta:"</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "lambda:"</span></span>
<span><span class="co">#&gt;  [1] 0.002791402 0.001978164 0.956164132 0.001747391 0.006934266 0.002839938</span></span>
<span><span class="co">#&gt;  [7] 0.013811496 0.001757617 0.006018121 0.005957472</span></span>
<span><span class="co">#&gt; [1] "After Condense 2"</span></span>
<span><span class="co">#&gt; [1] "theta:"</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "lambda:"</span></span>
<span><span class="co">#&gt;  [1] 0.002791402 0.001978164 0.956164132 0.001747391 0.006934266 0.002839938</span></span>
<span><span class="co">#&gt;  [7] 0.013811496 0.001757617 0.006018121 0.005957472</span></span>
<span><span class="co">#&gt; [1] "After Condense 2"</span></span>
<span><span class="co">#&gt; [1] "theta:"</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span>
<span><span class="co">#&gt; [1] "lambda:"</span></span>
<span><span class="co">#&gt;  [1] 0.002791402 0.001978164 0.956164132 0.001747391 0.006934266 0.002839938</span></span>
<span><span class="co">#&gt;  [7] 0.013811496 0.001757617 0.006018121 0.005957472</span></span>
<span><span class="co">#&gt; [1] "Stopping: Absolute change in objective function is smaller than theta_F."</span></span>
<span><span class="co">#&gt;      [,1]  [,2]   [,3]   [,4]    [,5]    [,6]    [,7]     [,8]     [,9]</span></span>
<span><span class="co">#&gt; [1,]    0 0.250 0.1250 0.3750 0.06250 0.31250 0.18750 -0.06250 0.031250</span></span>
<span><span class="co">#&gt; [2,]    1 0.625 0.9375 1.3125 0.53125 1.15625 1.46875  0.59375 0.796875</span></span>
<span><span class="co">#&gt;         [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.281250</span></span>
<span><span class="co">#&gt; [2,] 1.421875</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="step-w3---virtual-population-simulation">Step W3 - Virtual population simulation<a class="anchor" aria-label="anchor" href="#step-w3---virtual-population-simulation"></a>
</h2>
<p>The support points shown in Figure 4 (A-C) were used to construct a
Gaussian mixture model via the <code>mclust</code> R algorithm. Panels
D-F in Figure 4, show the same support points in panels A-C but with the
Gaussian mixture model clustering superimposed. Panels D-F respectively
show the clustering for scenarios in which two, four, and six clusters
are fitted to the support points. The color of the plotted points in
panels D-F indicate the cluster to which each point is assigned.</p>
<p>This figure shows that increasing the number of clusters more tightly
centers high probability regions of the Gaussian mixture model around
the high probability support points that were found by the NPOD
algorithm, whereas reducing the number of clusters increases the
probability of regions in the parameter space in between support
points.</p>
<p>Since this Gaussian mixture model will be used to generate a virtual
population through sampling, the number of clusters selected in this
step can impact the characteristics of the virtual individuals, and
hence, the final VBE assessment. The user may select the most
appropriate number of clusters using visual inspection of the clusters’
fits to the support points or using more quantitative approaches such as
the Akaike Information Criterion or the Bayesian Information Criterion
[20]. In this case, the four cluster Gaussian mixture model was
selected.</p>
<p>An internal validation of the four-cluster model against data set D1
was next performed. A virtual population, wherein each individual is
characterized by body weight, was generated by sampling within a range
of 50–100 kg of body weight . For each virtual individual,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\theta_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\theta_2</annotation></semantics></math>
were sampled from the Gaussian mixture model conditional on their body
weight. Using the testosterone dermal absorption model, testosterone
plasma concentration versus time profiles were then simulated for the
virtual population following administration of the reference petrolatum
formulation and compared to the corresponding measurements from data set
D1. The simulations assumed a testosterone dose of 2 μg/cm<sup>2</sup>
applied within a 25 mg/cm<sup>2</sup> vehicle. Figure 4G shows a
comparison between the 90% prediction interval of the virtual
population’s simulated testosterone plasma concentration versus time
profiles and the observed data set D1, showing that the model
predictions encompass the D1 dataset.</p>
<p>Figure 4H overlays the simulated testosterone plasma concentration
ranges for the R petrolatum formulation (in red) and T ethylene glycol
formulation (in blue) when both are applied at a dosage of 2
μg/cm<sup>2</sup>. This panel highlights that the virtual population’s
predicted testosterone exposure is higher with the petrolatum
formulation than with the ethylene glycol formulation, as reflected in
both the AUC and Cmax metrics.</p>
<p>A post-hoc external validation of the four-cluster model was also
performed by comparing the simulated testosterone plasma concentrations
versus time profiles of the virtual population following dermal
application of a 3 μg/cm<sup>2</sup> dose via the T product against
corresponding measurements. This comparison, in Figure 4I, shows that T
product model was largely able to predict the range of the measured
testosterone plasma concentration profile.</p>
<div class="section level3">
<h3 id="openvbe-code-3">openVBE code<a class="anchor" aria-label="anchor" href="#openvbe-code-3"></a>
</h3>
<p>Parameters to describe demographics (body weight) of study population
to create a virtual population:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Given values Median and CV body weight</span></span>
<span><span class="va">popBWMedian</span> <span class="op">&lt;-</span> <span class="fl">85</span> </span>
<span><span class="va">popBWCV</span> <span class="op">&lt;-</span> <span class="fl">0.148</span> </span>
<span></span>
<span><span class="co"># Compute lognormal parameters</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">popBWMedian</span><span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">popBWCV</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute confidence intervals</span></span>
<span><span class="va">CI_95</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">qlnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, meanlog <span class="op">=</span> <span class="va">mu</span>, sdlog <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demographyRanges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">CI_95</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">CI_95</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">"kg"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">virtualPopulation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createVirtualPopulation.html">createVirtualPopulation</a></span><span class="op">(</span></span>
<span>  inferredDistribution <span class="op">=</span> <span class="va">inferredDistribution</span>,</span>
<span>  numberOfVirtualIndividuals <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  clusters <span class="op">=</span> <span class="fu"><a href="../reference/getClusters.html">getClusters</a></span><span class="op">(</span></span>
<span>    inferredDistribution <span class="op">=</span> <span class="va">inferredDistribution</span>,</span>
<span>    numberOfClusters <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span>,</span>
<span>  demographyRanges <span class="op">=</span> <span class="va">demographyRanges</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Creating virtual population characteristics."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 1 of 100."</span></span>
<span><span class="co">#&gt; [1] "Building cluster model based on NPOD results."</span></span></code></pre></div>
<p><img src="testosterone-dermal_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 2 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 3 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 4 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 5 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 6 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 7 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 8 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 9 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 10 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 11 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 12 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 13 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 14 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 15 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 16 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 17 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 18 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 19 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 20 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 21 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 22 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 23 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 24 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 25 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 26 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 27 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 28 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 29 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 30 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 31 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 32 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 33 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 34 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 35 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 36 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 37 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 38 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 39 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 40 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 41 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 42 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 43 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 44 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 45 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 46 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 47 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 48 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 49 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 50 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 51 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 52 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 53 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 54 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 55 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 56 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 57 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 58 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 59 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 60 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 61 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 62 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 63 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 64 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 65 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 66 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 67 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 68 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 69 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 70 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 71 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 72 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 73 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 74 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 75 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 76 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 77 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 78 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 79 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 80 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 81 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 82 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 83 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 84 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 85 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 86 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 87 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 88 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 89 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 90 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 91 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 92 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 93 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 94 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 95 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 96 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 97 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 98 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 99 of 100."</span></span>
<span><span class="co">#&gt; [1] "Sampling from conditional distribution for individual 100 of 100."</span></span>
<span></span>
<span><span class="va">refAndTestSimulationsInVirtualPopulation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateVirtualPopulation.html">simulateVirtualPopulation</a></span><span class="op">(</span></span>
<span>  referenceSimulationFilePath <span class="op">=</span> <span class="va">referenceSimulationFilePath</span>,</span>
<span>  testSimulationFilePath <span class="op">=</span> <span class="va">testSimulationFilePath</span>,</span>
<span>  referencePopulationDataframe <span class="op">=</span> <span class="va">virtualPopulation</span><span class="op">$</span><span class="va">referencePopulationDataframe</span>,</span>
<span>  testPopulationDataframe <span class="op">=</span> <span class="va">virtualPopulation</span><span class="op">$</span><span class="va">testPopulationDataframe</span>,</span>
<span>  outputPath <span class="op">=</span> <span class="va">outputPath</span>,</span>
<span>  startTime <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  endTime <span class="op">=</span> <span class="fl">6000</span>, <span class="co"># min</span></span>
<span>  resolutionPtsMin <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">15</span> <span class="co"># pts/min</span></span>
<span>  <span class="op">)</span>  </span>
<span><span class="co">#&gt; [1] "Simulating virtual population."</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">subfolder</span>,<span class="st">"plotting_script.R"</span><span class="op">)</span>, encoding <span class="op">=</span> <span class="st">'UTF-8'</span><span class="op">)</span></span></code></pre></div>
<p><img src="testosterone-dermal_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="testosterone-dermal_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="step-w4---clinical-trial-simulation-and-vbe-evaluation">Step W4 - Clinical trial simulation and VBE evaluation<a class="anchor" aria-label="anchor" href="#step-w4---clinical-trial-simulation-and-vbe-evaluation"></a>
</h2>
<p>Figure 5 shows the results of the virtual bioequivalence assessment
that was performed using the testosterone plasma concentration versus
time profiles generated in the preceding step for the virtual population
for both the petrolatum and ethylene glycol formulations when applied at
the 2 μg/cm<sup>2</sup> dosage level. At each trial population size
between 5 and 50 subjects, 1000 clinical trials were conducted. In each
trial, the GMR of the PK parameter and its 90% CI are evaluated. The red
bands in Figure 5 panels A-D show the distribution of the point estimate
of the GMR of the PK parameter (AUC or Cmax) over the 1000 trials at
each trial size. Similarly, the lower and upper blue bands respectively
show the distribution of the lower and upper 90% CI of the GMR. Panel E
shows the probability of declaring BE at each trial size, which is the
fraction of the 1000 trials at each trial size that resulted in a
positive BE outcome (i.e., R and T were found bioequivalent).</p>
<p>As expected from a visual inspection of Figure 4H, the two
formulations were not bioequivalent in terms of AUC or Cmax. In Figure 5
(panels A-D), confidence intervals of the AUC and Cmax GMR ratios do not
fall within the 0.80 – 1.25 BE range for either the crossover or
parallel study designs. The probability of bioequivalence between the
ethylene glycol and petrolatum testosterone formulations for trial sizes
between 5 and 50 are also shown in Figure 5E. Under both the crossover
and parallel trial designs the probability of bioequivalence BE was very
small (&lt;0.05) in terms of both the AUC and Cmax.</p>
<div class="section level3">
<h3 id="openvbe-code-4">openVBE code<a class="anchor" aria-label="anchor" href="#openvbe-code-4"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ctsResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runClinicalTrialSimulation.html">runClinicalTrialSimulation</a></span><span class="op">(</span></span>
<span>  virtualPopulationSimulationResults <span class="op">=</span> <span class="va">refAndTestSimulationsInVirtualPopulation</span>,</span>
<span>  n_trials <span class="op">=</span> <span class="fl">1000</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Running clinical trial simulation."</span></span>
<span></span>
<span><span class="va">bandsPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotVBEBands.html">plotVBEBands</a></span><span class="op">(</span><span class="va">ctsResults</span><span class="op">)</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">bandsPlot</span><span class="op">)</span></span>
<span><span class="co">#&gt; $auc_par_all</span></span></code></pre></div>
<p><img src="testosterone-dermal_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $auc_cross_all</span></span></code></pre>
<p><img src="testosterone-dermal_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cmax_par_all</span></span></code></pre>
<p><img src="testosterone-dermal_files/figure-html/unnamed-chunk-8-3.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cmax_cross_all</span></span></code></pre>
<p><img src="testosterone-dermal_files/figure-html/unnamed-chunk-8-4.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">probabilityPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotVBEProbability.html">plotVBEProbability</a></span><span class="op">(</span><span class="va">ctsResults</span><span class="op">)</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">probabilityPlot</span><span class="op">)</span></span></code></pre></div>
<p><img src="testosterone-dermal_files/figure-html/unnamed-chunk-8-5.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Abdullah Hamadeh, Michael Neely, Pierre Chelle.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
